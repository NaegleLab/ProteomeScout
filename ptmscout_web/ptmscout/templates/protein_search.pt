<div metal:use-macro="layout">
	<div metal:fill-slot="header">
		<link rel="stylesheet" type="text/css" href="${request.static_url('ptmscout:static/css/proteins.css')}" />
	</div>
	<div metal:fill-slot="content">
		<form name="search" method="POST" action="">
			<fieldset>
				<legend>Search</legend>
				<input type="hidden" name="submitted" value="true">
				<p>
					<label for="acc_search">Protein:</label> 
					<input type="text" name="acc_search" value="${acc_search}">
					<span tal:condition="submitted and acc_search == ''" class="errortext">This term is required</span>
				</p>
				<p>
					<label for="stringency">Prediction Stringency:</label> <br />
					
					<input type="radio" name="stringency" value="1" tal:attributes="checked stringency == '1'"/> Low <br /> 
					<input type="radio" name="stringency" value="2" tal:attributes="checked stringency == '2'"/> Medium <br />
					<input type="radio" name="stringency" value="3" tal:attributes="checked stringency == '3'"/> High <br />
		
				</p>
				<p>
					<label for="species">Species:</label> <br /> 
					<select name="species">
						<option tal:condition="selected_species != None" tal:attributes="value selected_species" tal:content="selected_species"></option>
						<option value="all">all</option>
						<tal:empty tal:repeat="species species_list">
							<option tal:condition="selected_species != species" tal:attributes="value species" tal:content="species"></option>
						</tal:empty>
					</select>
				</p>
				<input type="submit" value="Search">
			</fieldset>
		</form>

		<div tal:condition="len(proteins) > 0" class="search_results">
			<div class="result_count">${len(proteins)} results</div>
			<table>
				<thead>
					<tr align="left" class="header">
						<th>Protein</th>
						<th>Species</th>
						<th>Site</th>
						<th>Aligned Sequence</th>
						<th>Predictions</th>
					</tr>
				</thead>

				<tbody>
					<tr valign="top" tal:repeat="(r, protein) enumerate(proteins)" tal:attributes="class 'row ' + 'even' if r % 2 == 0 else 'odd';" >
						<td><a tal:attributes="href request.application_url + '/proteins/' + str(protein.id)" tal:content="protein.acc_gene"></a></td>
						<td tal:content="protein.species.name"></td>
						<td>
							<div tal:repeat="phosphopep modifications[protein.id]" class="phosphopep_data" tal:content="phosphopep['site']"></div>
						</td>
						<td>
							<div tal:repeat="phosphopep modifications[protein.id]" class="phosphopep_data" tal:content="phosphopep['peptide']"></div>
						</td>
						<td>---</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</div>
	